{"id":"itv-slides-formatter-0vj","title":"Fix config.gs SpreadsheetApp references","description":"config.gs uses SpreadsheetApp.getActiveSpreadsheet() for settings persistence (lines 224-246). These calls fail silently in Slides context. Settings don't persist between sessions.\n\n**Acceptance criteria:**\n- [ ] Replace SpreadsheetApp calls with PropertiesService (user/document properties)\n- [ ] Settings persist per-presentation\n- [ ] Test: Change setting, close/reopen, setting retained","status":"closed","priority":2,"issue_type":"bug","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T00:10:30.964511Z","created_by":"spm1001","updated_at":"2026-01-17T07:49:16.062727Z","closed_at":"2026-01-17T07:49:16.062727Z","close_reason":"Replaced SpreadsheetApp with PropertiesService. Settings now persist per-presentation using config_${presentationId} keys."}
{"id":"itv-slides-formatter-3wv","title":"Measured contentUrl image resolution patterns","description":"**Experiment L5: contentUrl Image Resolution**\n\n**Hypothesis:** The contentUrl in a SheetsChart element provides an image at a specific resolution, which may or may not relate to container dimensions.\n\n**Method:**\n1. Embed same chart at three container sizes:\n   - Small: ~2.2\" × 1.35\"\n   - Medium: ~4.4\" × 2.7\"\n   - Large: ~8.7\" × 5.4\"\n2. For each, fetch the contentUrl\n3. Download each image, measure pixel dimensions\n4. Compare: does Google render higher-res images for larger containers?\n\n**Why This Matters:** Affects image quality at large sizes (print/export quality).","design":"## Approach\n\nEmbed at multiple sizes, download contentUrl images, measure pixels.\n\n## Observations Table\n| Container Size | Width (EMU) | Height (EMU) | Image Width (px) | Image Height (px) | Pixels/EMU |\n|----------------|-------------|--------------|------------------|-------------------|------------|\n| Small | 2000000 | 1238390 | | | |\n| Medium | 4000000 | 2476780 | | | |\n| Large | 8000000 | 4953560 | | | |\n\n## Acceptance Criteria\n- [ ] 3 container sizes tested\n- [ ] Image resolution measured for each\n- [ ] Resolution scaling pattern identified (or lack thereof)\n- [ ] Findings documented in L5-contenturl-resolution.md","status":"closed","priority":3,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:03:36.797462Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:49.152488Z","closed_at":"2026-01-17T17:13:49.152488Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-3wv","depends_on_id":"itv-slides-formatter-x9d","type":"parent-child","created_at":"2026-01-17T17:03:46.434186Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-45s","title":"Clean up test functions in main.gs","description":"main.gs has accumulated test functions:\n- testFontSwap()\n- testColorReadAndChange()\n- testReadMaster()\n- testCreateGridSlide()\n- enumerateSlide()\n- enumerateSlide2()\n\nConsider: namespace them (test_*), move to separate test.gs, or document which are one-off explorations vs ongoing tests.","status":"closed","priority":3,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T20:26:35.996268Z","created_by":"spm1001","updated_at":"2026-01-17T16:46:04.020297Z","closed_at":"2026-01-17T16:46:04.020297Z","close_reason":"Deferred - test functions useful during upcoming refactor","dependencies":[{"issue_id":"itv-slides-formatter-45s","depends_on_id":"itv-slides-formatter-9yi","type":"parent-child","created_at":"2026-01-16T22:07:25.724484Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-4nr","title":"Compared LINKED vs NOT_LINKED_IMAGE modes","description":"**Experiment L4: LINKED vs NOT_LINKED_IMAGE Behavior**\n\n**Hypothesis:** NOT_LINKED_IMAGE creates a frozen static image that behaves differently than LINKED charts for sizing and refresh.\n\n**Method:**\n1. Embed same chart twice: once LINKED, once NOT_LINKED_IMAGE\n2. Inspect both via API — what differs in PageElement structure?\n3. Resize both containers via UI\n4. Attempt refresh on both (expect: LINKED succeeds, NOT_LINKED fails)\n5. Modify source data in Sheets\n6. Attempt refresh again — observe behavior\n\n**Why This Matters:** Understanding static image mode may reveal useful edge cases.","design":"## Approach\n\nSide-by-side comparison of linking modes.\n\n## Observations Table\n| Aspect | LINKED | NOT_LINKED_IMAGE |\n|--------|--------|------------------|\n| PageElement type | | |\n| Has contentUrl? | | |\n| Has spreadsheetId ref? | | |\n| Refresh succeeds? | | |\n| Data change reflected? | | |\n| Resize behavior | | |\n\n## Acceptance Criteria\n- [ ] Both modes tested side-by-side\n- [ ] Structural differences documented\n- [ ] Refresh behavior differences documented\n- [ ] Findings documented in L4-linked-vs-static.md","status":"closed","priority":3,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:03:26.37491Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:49.073701Z","closed_at":"2026-01-17T17:13:49.073701Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-4nr","depends_on_id":"itv-slides-formatter-x9d","type":"parent-child","created_at":"2026-01-17T17:03:46.353489Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-511","title":"Test writing to theme color palette","description":"We proved we can READ the theme palette (colorScheme.colors) and SET elements to use theme references ({themeColor: \"ACCENT1\"}).\n\nOpen question: Can we MODIFY what ACCENT1 means in the master? If so, all elements using that reference would update automatically.\n\nTest: updatePageProperties or similar to change colorScheme values.","status":"open","priority":3,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T20:26:28.85828Z","created_by":"spm1001","updated_at":"2026-01-16T20:26:28.85828Z","dependencies":[{"issue_id":"itv-slides-formatter-511","depends_on_id":"itv-slides-formatter-9yi","type":"parent-child","created_at":"2026-01-16T22:07:25.644595Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-5ju","title":"Decouple auth and configure scopes","description":"Decouple from mcp-google-workspace token and configure correct OAuth scopes.\n\n**Acceptance criteria:**\n- [x] Update deploy.json to use local ./credentials.json and ./token.json\n- [x] Update package.json auth scripts to use itv-appscript auth (shows GCP project number)\n- [ ] Keep existing scopes: presentations, drive, spreadsheets (needed for linked charts)\n- [ ] Add Apps Script deployment scopes: script.projects, script.deployments\n- [ ] Auth with itv-google-auth to get fresh token with correct scopes\n- [ ] Test: itv-appscript deploy and itv-appscript run both work\n- [ ] Document the change in CLAUDE.md\n\n**Progress:** deploy.json and package.json updated (2026-01-16). Next: run itv-appscript auth to generate local token.","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T20:26:21.283277Z","created_by":"spm1001","updated_at":"2026-01-16T22:44:54.405709Z","closed_at":"2026-01-16T22:44:54.405709Z","close_reason":"Auth decoupled: local credentials.json and token.json from itv-mit-slides-formatter GCP project. Both deploy and run now work. CLAUDE.md updated.","dependencies":[{"issue_id":"itv-slides-formatter-5ju","depends_on_id":"itv-slides-formatter-bzd","type":"parent-child","created_at":"2026-01-16T21:42:04.732027Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-8ke","title":"Determined chart sheet aspect ratio behavior","description":"**Experiment S1: Chart Sheet Aspect Ratio Discovery**\n\n**Hypothesis:** When a chart is on its own sheet (no overlayPosition), Google uses some default aspect ratio when rendering for export/embedding. This ratio may be consistent across chart types, or may vary.\n\n**Method:**\n1. Create a bar chart as floating (default 600×371, AR=1.617)\n2. Move to own sheet (using S4 method)\n3. Verify via API: position.sheetId present, no overlayPosition\n4. Export chart sheet as image\n5. Measure exported image pixel dimensions\n6. Calculate aspect ratio\n7. Repeat for: line, pie, area, combo charts\n\n**Key Question:** Is the chart sheet AR consistent (always ~1.617), or does it vary by type?","design":"## Approach\n\nExport chart sheet charts as images and measure actual dimensions.\n\n## Key API Call\n```javascript\nfunction exportChartImage(spreadsheetId, chartId) {\n  const chart = SpreadsheetApp.openById(spreadsheetId)\n    .getCharts()\n    .find(c =\u003e c.getChartId() === chartId);\n  const blob = chart.getAs('image/png');\n  DriveApp.createFile(blob.setName(`chart_${chartId}_export.png`));\n  return blob;\n}\n```\n\n## Observations Table\n| Chart Type | Floating AR | Export Width | Export Height | Chart Sheet AR |\n|------------|-------------|--------------|---------------|----------------|\n| Bar        | 1.617       |              |               |                |\n| Line       | 1.617       |              |               |                |\n| Pie        | 1.617       |              |               |                |\n\n## Acceptance Criteria\n- [ ] At least 3 chart types tested\n- [ ] Aspect ratios calculated and compared\n- [ ] Consistency pattern identified (or variance documented)\n- [ ] Findings documented in S1-chart-sheet-ar.md","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:02:07.206463Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:48.68504Z","closed_at":"2026-01-17T17:13:48.68504Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-8ke","depends_on_id":"itv-slides-formatter-cvf","type":"parent-child","created_at":"2026-01-17T17:02:27.874742Z","created_by":"spm1001"},{"issue_id":"itv-slides-formatter-8ke","depends_on_id":"itv-slides-formatter-sev","type":"blocks","created_at":"2026-01-17T17:02:28.041618Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-9s2","title":"Determined chart sheet embedding constraints","description":"**Experiment L2: Chart Sheet Embedding Behavior**\n\n**Hypothesis:** When embedding a chart sheet (no dimensions in Sheets), Slides uses some internal aspect ratio we cannot control.\n\n**Method:**\n1. Create bar chart, move to own sheet (no overlayPosition)\n2. Embed into Slides with various containers: 16:9, 4:3, 1:1\n3. For each: visually inspect letterboxing, fetch contentUrl, compare dimensions\n4. Repeat with pie chart (different content shape)\n\n**Key Question:** Is the apparent chart AR consistent across container sizes? Can we discover the \"native\" AR?\n\n**Depends on:** S1 (chart sheet AR discovery) for baseline understanding.","design":"## Approach\n\nEmbed chart sheet charts at various container sizes, measure behavior.\n\n## Observations Table\n| Container AR | Chart Type | Letterbox? | Location | Apparent Chart AR |\n|--------------|------------|------------|----------|-------------------|\n| 1.778 (16:9) | Bar | | | |\n| 1.333 (4:3) | Bar | | | |\n| 1.000 (1:1) | Bar | | | |\n| 1.778 (16:9) | Pie | | | |\n\n## Acceptance Criteria\n- [ ] Chart sheet embedding tested at 3+ container sizes\n- [ ] Apparent AR calculated from letterbox measurements\n- [ ] Consistency pattern identified\n- [ ] Findings documented in L2-chart-sheet-embedding.md","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:03:04.284627Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:48.919418Z","closed_at":"2026-01-17T17:13:48.919418Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-9s2","depends_on_id":"itv-slides-formatter-x9d","type":"parent-child","created_at":"2026-01-17T17:03:46.189607Z","created_by":"spm1001"},{"issue_id":"itv-slides-formatter-9s2","depends_on_id":"itv-slides-formatter-8ke","type":"blocks","created_at":"2026-01-17T17:03:46.517552Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-9yi","title":"Formatter does useful things to presentations","description":"The actual formatting functionality - what rules to apply, what to change, how to transform presentations. Distinct from infrastructure (auth, deployment, distribution).","status":"open","priority":2,"issue_type":"epic","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T22:07:16.556096Z","created_by":"spm1001","updated_at":"2026-01-16T22:07:16.556096Z","dependencies":[{"issue_id":"itv-slides-formatter-9yi","depends_on_id":"itv-slides-formatter-cvf","type":"blocks","created_at":"2026-01-17T17:14:26.736523Z","created_by":"spm1001"},{"issue_id":"itv-slides-formatter-9yi","depends_on_id":"itv-slides-formatter-x9d","type":"blocks","created_at":"2026-01-17T17:14:26.822892Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-bwb","title":"Confirmed floating chart dimensions are fully controllable via API","description":"**Experiment S2: Floating Chart Dimension Control**\n\n**Hypothesis:** We can set arbitrary dimensions on floating charts via UpdateEmbeddedObjectPositionRequest, and those dimensions persist.\n\n**Method:**\n1. Create a floating bar chart with default dimensions (600×371)\n2. Read initial dimensions via API\n3. Resize to 16:9 ratio (960×540) via UpdateEmbeddedObjectPosition\n4. Verify dimensions match requested\n5. Close/reopen spreadsheet, verify persistence\n6. Resize to 1:1 (500×500)\n7. Export as image, verify export matches specified dimensions\n\n**Why First:** This is foundational — if we can't control floating chart dimensions, many strategies fail.","design":"## Approach\n\nUse Sheets API batchUpdate with updateEmbeddedObjectPosition request.\n\n## Key API Call\n```javascript\nSheets.Spreadsheets.batchUpdate({\n  requests: [{\n    updateEmbeddedObjectPosition: {\n      objectId: chartId,\n      newPosition: {\n        overlayPosition: {\n          anchorCell: { sheetId: 0, rowIndex: 10, columnIndex: 0 },\n          widthPixels: width,\n          heightPixels: height\n        }\n      },\n      fields: 'overlayPosition(anchorCell,widthPixels,heightPixels)'\n    }\n  }]\n}, spreadsheetId);\n```\n\n## Acceptance Criteria\n- [ ] Default dimensions recorded (expect 600×371)\n- [ ] 16:9 resize succeeds and persists\n- [ ] 1:1 resize succeeds\n- [ ] Export matches specified dimensions\n- [ ] Findings documented in S2-dimension-control.md","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:01:43.673997Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:48.51369Z","closed_at":"2026-01-17T17:13:48.51369Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-bwb","depends_on_id":"itv-slides-formatter-cvf","type":"parent-child","created_at":"2026-01-17T17:02:27.699708Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-bzd","title":"Auth Rationalization","description":"Untangle auth so itv-slides-formatter has its own minimal-scope token, with proper service account for production deployment.\n\n**Current state:** Uses mcp-google-workspace token (15+ scopes), creating scope creep and tangled dependencies.\n\n**Target state:**\n- Own token.json with appropriate scopes (presentations, drive, spreadsheets, script.*)\n- GCP project stays separate (itv-mit-slides-formatter)\n- Service account for production deployment\n- GitHub Actions CI/CD for production deploys\n- ~20 users can install via shared URL\n\nSee plan: ~/.claude/plans/spicy-growing-sprout.md","status":"closed","priority":1,"issue_type":"epic","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T21:41:54.350104Z","created_by":"spm1001","updated_at":"2026-01-17T16:40:39.148536Z","closed_at":"2026-01-17T16:40:39.148536Z","close_reason":"All auth work complete: standalone OAuth, production CI/CD (PAT/netrc), user install docs."}
{"id":"itv-slides-formatter-bzd.1","title":"Create GCP service account for production","description":"Set up a service account for production deployments.\n\n**Acceptance criteria:**\n- [ ] Create service account in itv-mit-slides-formatter GCP project\n- [ ] Grant minimal roles (Apps Script API, Slides API)\n- [ ] Download service account key JSON\n- [ ] Store in GitHub Secrets as GOOGLE_SA_KEY\n- [ ] Optional: Store locally in ~/.credentials/ for manual production deploys","notes":"## Blocked: Service accounts don't work with Apps Script\n\n**Discovery (Jan 2026):** Apps Script API requires user context. Service accounts can't own or deploy to Apps Script projects without domain-wide delegation.\n\n**Options explored:**\n- Service Account Token Creator role — doesn't help, wrong use case\n- Direct service account — can't own Apps Script projects\n\n**Path forward:** Either:\n1. Domain-wide delegation (needs Workspace admin)\n2. Shared user account (mit-slides-tools@itv.com) — simpler, see DISTRIBUTION.md\n\nParking this pending delegation setup or pivot to shared account approach.","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T21:42:26.458715Z","created_by":"spm1001","updated_at":"2026-01-16T23:14:03.89644Z","closed_at":"2026-01-16T23:14:03.89644Z","close_reason":"Pivoted to shared account (measurement@itv.com) instead. Service accounts can't own Apps Script projects without domain-wide delegation. Shared account setup complete - see DISTRIBUTION.md.","dependencies":[{"issue_id":"itv-slides-formatter-bzd.1","depends_on_id":"itv-slides-formatter-bzd","type":"parent-child","created_at":"2026-01-16T21:42:26.459311Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-bzd.2","title":"Configure production deployment with CI/CD","description":"Set up production Apps Script project and GitHub Actions for automated deployment.\n\n**Acceptance criteria:**\n- [ ] Create production Apps Script project (share with service account as Editor)\n- [ ] Create deploy.production.json pointing to service account credentials\n- [ ] Create GitHub Actions workflow for production deploy on merge to main\n- [ ] Document manual production deploy workflow (fallback)\n- [ ] Test: Push to main triggers deploy to production","notes":"## Session 2026-01-17\n\nCOMPLETED:\n- GitHub Actions workflow created (.github/workflows/deploy-production.yml)\n- DISTRIBUTION.md updated with secrets docs\n\nATTEMPTED (deploy keys):\n- Set up DEPLOY_KEY for itv-appscript-deploy\n- Set up DEPLOY_KEY_AUTH for itv-google-auth  \n- Added git config insteadOf to rewrite HTTPS→SSH\n- FAILED: uv uses libgit2 internally, doesn't respect git config insteadOf\n\nPATH FORWARD:\n1. Create fine-grained PAT scoped to both repos (Contents: read-only)\n2. Save as GH_PAT secret in itv-slides-formatter\n3. Update workflow to use HTTPS + PAT (revert SSH changes)\n4. Test workflow\n5. Update DISTRIBUTION.md with final secret names\n\nThe deploy keys exist but don't work for this use case. Consider removing after PAT works.","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T21:42:27.690012Z","created_by":"spm1001","updated_at":"2026-01-17T16:40:13.607248Z","closed_at":"2026-01-17T16:40:13.607248Z","close_reason":"PAT via netrc approach works. Deploy keys not needed.","dependencies":[{"issue_id":"itv-slides-formatter-bzd.2","depends_on_id":"itv-slides-formatter-bzd","type":"parent-child","created_at":"2026-01-16T21:42:27.690673Z","created_by":"spm1001"},{"issue_id":"itv-slides-formatter-bzd.2","depends_on_id":"itv-slides-formatter-bzd.1","type":"blocks","created_at":"2026-01-16T21:42:39.22267Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-bzd.3","title":"Set up user installation flow","description":"Enable ~20 users to install the add-on and receive automatic updates.\n\n**Acceptance criteria:**\n- [ ] Create versioned add-on deployment in production project\n- [ ] Document install URL for users\n- [ ] Test: Fresh user can install and use add-on\n- [ ] Verify updates propagate automatically when new version is created","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T21:42:28.946329Z","created_by":"spm1001","updated_at":"2026-01-17T00:03:50.95182Z","closed_at":"2026-01-17T00:03:50.95182Z","close_reason":"User installation flow working. Test deployment via Editor access. Fixed: SpreadsheetApp→SlidesApp, HtmlService.createHtml→createHtmlOutput, added script.container.ui scope. UX polish needed (auto-detect presentation, Marketplace for non-editor users).","dependencies":[{"issue_id":"itv-slides-formatter-bzd.3","depends_on_id":"itv-slides-formatter-bzd","type":"parent-child","created_at":"2026-01-16T21:42:28.947093Z","created_by":"spm1001"},{"issue_id":"itv-slides-formatter-bzd.3","depends_on_id":"itv-slides-formatter-bzd.2","type":"blocks","created_at":"2026-01-16T21:42:39.298666Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-cvf","title":"Established ground truth about Sheets chart API capabilities","description":"Discover what we can control programmatically in Sheets charts vs what requires UI intervention.\n\n**Test Environment:**\n- Spreadsheet: https://docs.google.com/spreadsheets/d/1uVNby-sLTDIyozwrzAXpgLWlkweIe4L94nWZZvcmps4\n- Presentation: https://docs.google.com/presentation/d/1jCr7vmCg_XciYFbxX9oy4VM9OnPqkjfJj7Bbt2X2pwU\n- Findings folder: RAGE AGAINST THE MACHINE/Slides API Experiments/Findings/\n\n**Protocol Reference:** See experimental-protocol.md in repo root\n\nThis is Phase 1 of the experimental work. Must complete before L-series (linking experiments).","status":"open","priority":1,"issue_type":"epic","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:01:30.442847Z","created_by":"spm1001","updated_at":"2026-01-17T17:01:30.442847Z"}
{"id":"itv-slides-formatter-cvf.1","title":"Confirmed floating chart dimensions are fully controllable via API","description":"Experiment S2: Test UpdateEmbeddedObjectPositionRequest for dimension control","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:00.107493Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:00.107493Z"}
{"id":"itv-slides-formatter-cvf.2","title":"Verified charts can be moved to own sheet via API","description":"Experiment S4: Test newSheet: true for programmatic chart sheet creation","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:00.230772Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:00.230772Z"}
{"id":"itv-slides-formatter-cvf.3","title":"Determined chart sheet aspect ratio behavior","description":"Experiment S1: Export chart sheet images, measure AR across chart types","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:00.353851Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:00.353851Z","dependencies":[{"issue_id":"itv-slides-formatter-cvf.3","depends_on_id":"itv-slides-formatter-cvf.2","type":"blocks","created_at":"2026-01-17T17:14:19.997186Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-cvf.4","title":"Mapped the API ceiling for chart styling properties","description":"Experiment S3: Test each styling property via UpdateChartSpecRequest","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:00.470202Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:00.470202Z"}
{"id":"itv-slides-formatter-dw9","title":"Established refresh behavior after container resize","description":"**Experiment L3: Refresh Behavior After Container Resize**\n\n**Hypothesis:** After resizing an embedded chart's container in Slides, RefreshSheetsChartRequest may or may not respect the new dimensions.\n\n**Method:**\n1. Embed linked chart with specific container dimensions\n2. Record dimensions via API\n3. Resize container via UI (drag handle) to significantly different dimensions\n4. Record new dimensions via API\n5. Modify source chart in Sheets (change a data value)\n6. Call RefreshSheetsChartRequest\n7. Record dimensions after refresh — did they change?\n\n**Critical Question:** Does refresh preserve user-resized dimensions, reset to original, or adapt?\n\nThis is architecturally critical — determines whether we need post-refresh adjustment.","design":"## Approach\n\nResize embedded chart, then trigger refresh and observe dimension behavior.\n\n## Key API Call\n```javascript\nSlides.Presentations.batchUpdate({\n  requests: [{\n    refreshSheetsChart: { objectId: chartObjectId }\n  }]\n}, presentationId);\n```\n\n## Observations Table\n| Step | Width (EMU) | Height (EMU) | AR | Visual State |\n|------|-------------|--------------|-----|--------------|\n| Initial embed | | | | |\n| After UI resize | | | | |\n| After refresh | | | | |\n\n## Acceptance Criteria\n- [ ] Dimension behavior after refresh documented\n- [ ] Determines: preserve / reset / adapt\n- [ ] Architectural implications stated\n- [ ] Findings documented in L3-refresh-behavior.md","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:03:15.901788Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:48.996144Z","closed_at":"2026-01-17T17:13:48.996144Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-dw9","depends_on_id":"itv-slides-formatter-x9d","type":"parent-child","created_at":"2026-01-17T17:03:46.272028Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-f51","title":"Documented embedding aspect ratio and letterboxing behavior","description":"**Experiment L1: Embedding Aspect Ratio Behavior**\n\n**Hypothesis:** When embedding a chart into Slides, the chart maintains its aspect ratio and letterboxes within the specified container.\n\n**Method:**\n1. Create floating chart with known dimensions (600×371, AR=1.617)\n2. Embed with MATCHING container (AR=1.617) — expect fill, no letterbox\n3. Fetch contentUrl, measure actual image dimensions\n4. Embed with MISMATCHED container (16:9 = AR 1.778) — expect letterbox\n5. Visually inspect, measure letterbox margins\n6. Repeat with 1:1 and 4:3 containers\n\n**Key Question:** Does Slides stretch charts or letterbox them? How much letterbox for common AR mismatches?","design":"## Approach\n\nUse createSheetsChart with various container dimensions, then inspect.\n\n## Key API Call\n```javascript\nSlides.Presentations.batchUpdate({\n  requests: [{\n    createSheetsChart: {\n      spreadsheetId: ssId,\n      chartId: chartId,\n      linkingMode: 'LINKED',\n      elementProperties: {\n        pageObjectId: slideId,\n        size: { width: { magnitude: widthEmu, unit: 'EMU' }, height: { magnitude: heightEmu, unit: 'EMU' } },\n        transform: { scaleX: 1, scaleY: 1, translateX: 914400, translateY: 914400, unit: 'EMU' }\n      }\n    }\n  }]\n}, presId);\n```\n\n## Observations Table\n| Container AR | Chart AR | Expected | Actual | Letterbox Location | Letterbox Size |\n|--------------|----------|----------|--------|-------------------|----------------|\n| 1.617 (match) | 1.617 | Fill | | | |\n| 1.778 (16:9) | 1.617 | Side letterbox | | | |\n| 1.000 (1:1) | 1.617 | Top/bottom | | | |\n\n## Acceptance Criteria\n- [ ] At least 3 container ARs tested\n- [ ] Letterbox vs stretch behavior confirmed\n- [ ] Letterbox margins quantified\n- [ ] Findings documented in L1-embedding-ar.md","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:02:54.24506Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:48.839526Z","closed_at":"2026-01-17T17:13:48.839526Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-f51","depends_on_id":"itv-slides-formatter-x9d","type":"parent-child","created_at":"2026-01-17T17:03:46.098739Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-gmp","title":"Mapped the API ceiling for chart styling properties","description":"**Experiment S3: Chart Styling API Coverage**\n\n**Hypothesis:** Some chart style properties are API-controllable, others are UI-only. We need to map the boundary.\n\n**Method:** For each property category, attempt to set via UpdateChartSpecRequest and verify:\n\n1. Background color (chartStyle.backgroundColor)\n2. Title text and formatting (title, titleTextFormat)\n3. Legend position (basicChart.legendPosition)\n4. Axis titles and formatting (basicChart.axis[].title, format)\n5. Axis label formatting (likely UI-only)\n6. Series colors (basicChart.series[].color)\n7. Gridlines (likely UI-only)\n8. Data labels (basicChart.series[].dataLabel)\n\n**Why This Matters:** The \"API ceiling\" determines what we can automate vs what requires templates or user intervention.","design":"## Approach\n\nSystematically test each styling property via updateChartSpec.\n\n## Property Test Matrix\n| Property | API Field | Set Successful? | Persisted? |\n|----------|-----------|-----------------|------------|\n| Background color | chartStyle.backgroundColor | | |\n| Title text | title | | |\n| Title font | titleTextFormat.fontFamily | | |\n| Legend position | basicChart.legendPosition | | |\n| Axis title | basicChart.axis[].title | | |\n| Series color | basicChart.series[].color | | |\n| Gridline visibility | ??? | | |\n| Data labels | basicChart.series[].dataLabel | | |\n\n## Acceptance Criteria\n- [ ] All properties in matrix tested\n- [ ] API-controllable vs UI-only clearly distinguished\n- [ ] Workarounds noted where applicable\n- [ ] Findings documented in S3-styling-api-ceiling.md","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:02:19.152552Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:48.761621Z","closed_at":"2026-01-17T17:13:48.761621Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-gmp","depends_on_id":"itv-slides-formatter-cvf","type":"parent-child","created_at":"2026-01-17T17:02:27.959008Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-h28","title":"Reverse-engineered golden documents to surface tacit design standards","description":"**DEFERRED** — Requires golden documents from ITV design team.\n\nAnalyze well-designed presentations and charts to discover:\n- API ceiling (what can't be set programmatically)\n- Tacit design knowledge (defaults designers rely on without documenting)\n- Template hygiene issues (misused placeholders, inconsistent inheritance)\n- Opportunities for template purification\n\n**Prerequisites (before starting):**\n- [ ] Golden Slides deck obtained from design team\n- [ ] Golden Sheets charts obtained (source spreadsheets)\n- [ ] Brand spec documentation obtained\n- [ ] Designer contact for \"was this intentional?\" questions\n\n**Contains:** G1-G5 experiments (to be created when prerequisites met)\n\n**Depends on:** S-series and L-series provide foundational API understanding.","status":"open","priority":3,"issue_type":"epic","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:03:56.325496Z","created_by":"spm1001","updated_at":"2026-01-17T17:03:56.325496Z","dependencies":[{"issue_id":"itv-slides-formatter-h28","depends_on_id":"itv-slides-formatter-x9d","type":"blocks","created_at":"2026-01-17T17:04:01.627373Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-oxh","title":"Get designer input on shopping list","description":"Created docs/DESIGNER_SHOPPING_LIST.md with all properties designers need to specify. Waiting for actual ITV designed template before sending to designers. See Appendix C for goblin census.","notes":"2026-01-16: Test artifacts confirmed deleted.\n\nSession learnings:\n- Proved color read/write works (RGB and theme references)\n- Can read full master template: colorScheme, placeholders, layouts\n- Created grid illustration slides (16×9, 32×18, 80×45)\n- Grid recommendation: 114,300 EMU = 80×45 = ⅛\" cells\n\nRemote execution blocked by GCP project mismatch (see CLAUDE.md Known Issues).\nStill waiting for ITV designed template from designers.","status":"closed","priority":2,"issue_type":"task","created_at":"2026-01-10T22:40:06.48829Z","created_by":"modha","updated_at":"2026-01-17T09:02:21.887207Z","closed_at":"2026-01-17T09:02:21.887207Z","close_reason":"Alternative approach found","dependencies":[{"issue_id":"itv-slides-formatter-oxh","depends_on_id":"itv-slides-formatter-9yi","type":"parent-child","created_at":"2026-01-16T22:07:25.557723Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-sev","title":"Verified charts can be moved to own sheet via API","description":"**Experiment S4: Move to Own Sheet via API**\n\n**Hypothesis:** We can programmatically move a floating chart to its own sheet using UpdateEmbeddedObjectPositionRequest with newSheet: true.\n\n**Method:**\n1. Create a floating chart\n2. Record chartId and current position\n3. Move to own sheet via API (newPosition.newSheet: true)\n4. Verify chart now has position.sheetId (not overlayPosition)\n5. Record auto-generated sheet name and ID\n6. Attempt to rename the sheet via updateSheetProperties\n7. Verify rename succeeded\n\n**Why This Matters:** If we can enforce \"chart on own sheet\" programmatically, we control the source format.","design":"## Approach\n\nUse updateEmbeddedObjectPosition with newSheet: true flag.\n\n## Key API Call\n```javascript\nSheets.Spreadsheets.batchUpdate({\n  requests: [{\n    updateEmbeddedObjectPosition: {\n      objectId: chartId,\n      newPosition: {\n        newSheet: true\n      }\n    }\n  }]\n}, spreadsheetId);\n```\n\n## Acceptance Criteria\n- [ ] Floating → Chart sheet move succeeds\n- [ ] position.sheetId present after move\n- [ ] Auto-generated sheet name recorded\n- [ ] Sheet rename succeeds\n- [ ] Findings documented in S4-move-to-sheet.md","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:01:53.794084Z","created_by":"spm1001","updated_at":"2026-01-17T17:13:48.607675Z","closed_at":"2026-01-17T17:13:48.607675Z","close_reason":"Recreating with .n notation","dependencies":[{"issue_id":"itv-slides-formatter-sev","depends_on_id":"itv-slides-formatter-cvf","type":"parent-child","created_at":"2026-01-17T17:02:27.795176Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-x5g","title":"Publish to Google Workspace Marketplace (private)","description":"For non-developer users to install without Editor access to the Apps Script project.\n\n**Context:** Test deployment requires Editor access. Marketplace publishing enables Extensions → Add-ons → Get add-ons installation for any ITV user.\n\n**Acceptance criteria:**\n- [ ] Configure add-on manifest for Marketplace\n- [ ] Submit for private publishing (ITV domain only)\n- [ ] Test: User without Editor access can install via Marketplace\n- [ ] Update DISTRIBUTION.md with install instructions","status":"closed","priority":3,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T00:10:37.584824Z","created_by":"spm1001","updated_at":"2026-01-17T16:44:26.928015Z","closed_at":"2026-01-17T16:44:26.928015Z","close_reason":"Deferred - Marketplace publishing not needed yet"}
{"id":"itv-slides-formatter-x9d","title":"Understood how Sheets charts behave when embedded in Slides","description":"Discover the mechanics of Sheets→Slides chart embedding: aspect ratios, letterboxing, refresh behavior, resolution.\n\n**Test Environment:**\n- Spreadsheet: https://docs.google.com/spreadsheets/d/1uVNby-sLTDIyozwrzAXpgLWlkweIe4L94nWZZvcmps4\n- Presentation: https://docs.google.com/presentation/d/1jCr7vmCg_XciYFbxX9oy4VM9OnPqkjfJj7Bbt2X2pwU\n- Findings folder: RAGE AGAINST THE MACHINE/Slides API Experiments/Findings/\n\n**Protocol Reference:** See experimental-protocol.md in repo root\n\n**Depends on:** S-series (Sheets experiments) — need to understand Sheets chart behavior before testing embedding.","status":"open","priority":1,"issue_type":"epic","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:02:35.044733Z","created_by":"spm1001","updated_at":"2026-01-17T17:02:35.044733Z","dependencies":[{"issue_id":"itv-slides-formatter-x9d","depends_on_id":"itv-slides-formatter-cvf","type":"blocks","created_at":"2026-01-17T17:03:46.599222Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-x9d.1","title":"Documented embedding aspect ratio and letterboxing behavior","description":"Experiment L1: Test createSheetsChart with various container ARs","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:09.482217Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:09.482217Z"}
{"id":"itv-slides-formatter-x9d.2","title":"Determined chart sheet embedding constraints","description":"Experiment L2: Embed chart sheets, measure apparent AR","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:09.589595Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:09.589595Z","dependencies":[{"issue_id":"itv-slides-formatter-x9d.2","depends_on_id":"itv-slides-formatter-cvf.3","type":"blocks","created_at":"2026-01-17T17:14:20.41616Z","created_by":"spm1001"}]}
{"id":"itv-slides-formatter-x9d.3","title":"Established refresh behavior after container resize","description":"Experiment L3: Critical - does RefreshSheetsChartRequest preserve user-resized dimensions?","status":"open","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:09.698162Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:09.698162Z"}
{"id":"itv-slides-formatter-x9d.4","title":"Compared LINKED vs NOT_LINKED_IMAGE modes","description":"Experiment L4: Side-by-side comparison of linking modes","status":"open","priority":3,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:09.812028Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:09.812028Z"}
{"id":"itv-slides-formatter-x9d.5","title":"Measured contentUrl image resolution patterns","description":"Experiment L5: Does Google render higher-res images for larger containers?","status":"open","priority":3,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-17T17:14:09.908533Z","created_by":"spm1001","updated_at":"2026-01-17T17:14:09.908533Z"}
{"id":"itv-slides-formatter-ypk","title":"Set up colleague dev workflow","description":"Set up colleague dev workflow so teammates can independently develop and test.\n\n**Acceptance criteria:**\n- [ ] Create deploy.json.template showing structure (gitignored deploy.json, not template)\n- [ ] Update docs/DISTRIBUTION.md with credential sharing instructions\n- [ ] Document: clone → get credentials.json → auth → deploy to sandbox\n- [ ] Share credentials.json with colleague via secure channel\n- [ ] Test: Colleague can set up and deploy independently","notes":"COMPLETED (2026-01-17):\n- deploy.json.template created, deploy.json gitignored\n- docs/DISTRIBUTION.md updated with credential sharing (GCP Console only)\n- README.md, CLAUDE.md, DISTRIBUTION.md standardized on `uv tool install`\n- Removed all ~/Repos/ hardcoded paths\n- Removed itv-google-auth as explicit prereq (it's transitive)\n\nREMAINING (manual):\n- Share GCP project access with colleague\n- Colleague tests full onboarding flow independently","status":"closed","priority":2,"issue_type":"task","owner":"spm1001@users.noreply.github.com","created_at":"2026-01-16T20:26:43.720374Z","created_by":"spm1001","updated_at":"2026-01-17T17:16:31.134873Z","closed_at":"2026-01-17T17:16:31.134873Z","close_reason":"Colleague dev workflow docs complete. Awaiting manual test by colleague with GCP access.","dependencies":[{"issue_id":"itv-slides-formatter-ypk","depends_on_id":"itv-slides-formatter-bzd","type":"parent-child","created_at":"2026-01-16T21:42:13.447748Z","created_by":"spm1001"},{"issue_id":"itv-slides-formatter-ypk","depends_on_id":"itv-slides-formatter-5ju","type":"blocks","created_at":"2026-01-16T21:42:39.146479Z","created_by":"spm1001"}]}
